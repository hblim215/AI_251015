## 자동차 퀴즈 앱 설계

### 1. 목표
- `car_picker/data` 폴더에 있는 차량 이미지를 활용해 제조사, 모델, 연식을 맞추는 10지선다 퀴즈 제공
- 점수 및 진행 상황을 세션 내에서 추적하고, Streamlit 웹 UI로 즉각 피드백 전달

### 2. 데이터 준비 전략
- 스크래퍼 README 규칙을 바탕으로 파일명 형식 `Make_Model_Year_...`를 파싱
- 필수 정보: 제조사(`make`), 모델(`model`), 연식(`year`)
- 파싱 단계
  1. 파일명에서 확장자 제거 후 언더스코어(`_`) 기준 분리
  2. 선행 3개 토큰을 각각 제조사/모델/연식으로 매핑
  3. 연식이 정수인지 검증, 모델명 내 스페이스는 `-` 또는 추가 토큰 병합으로 처리
  4. 나머지 토큰은 현재 퀴즈에 필요하지 않지만, 차종/구동방식 등의 확장 정보를 위한 원천 데이터로 보존 가능
- 결과를 `data/metadata.csv`로 저장하여 초기 로딩 속도 및 재사용성 확보
- 이미지 파일 존재 여부를 검증하고 누락/손상된 항목은 필터링

### 3. 애플리케이션 구성
- **메타데이터 로더 (`metadata_loader.py`)**
  - 파일명 파싱 및 CSV 캐싱 로직 구현
  - 최초 실행 시 파싱 후 CSV 생성, 이후에는 CSV 우선 로딩
  - 확장성: CLI 옵션으로 캐시 무효화 가능 (`--refresh-metadata`)
- **퀴즈 엔진 (`quiz_engine.py`)**
  - `get_random_question()`에서 문제 이미지와 10개의 보기(정답 1 + 오답 9) 반환
  - 오답은 동일 제조사 또는 인접 연식 위주로 선별하여 난이도 균형
  - `validate_answer()`는 선택한 보기와 정답 비교 후 피드백 구성
  - 세션 상태: 점수, 총 문제 수, 연속 정답, 최근 선택 기록 등 관리
- **Streamlit UI (`app.py`)**
  - 이미지 표시, 10개 버튼형 보기, 결과 메시지, 현재 점수/진행도 표시
  - “다음 문제” 버튼 및 힌트 토글(예: 제조사만 공개) 지원
  - 앱 시작 시 메타데이터 로딩 → 세션 상태 초기화 → 퀴즈 엔진 호출

### 4. 상태 및 세션 관리
- Streamlit `st.session_state`에 점수(`score`), 문제 번호(`question_index`), 최근 정답 여부 저장
- 문제별 정답 선택 후 즉시 결과 표시, `다음 문제` 클릭 시 새로운 질문 생성
- 향후 기능 대비를 위해 세션 로그(문제/정답/선택/시간)를 별도 리스트로 보관 가능

### 5. 예외 처리 및 유효성 검증
- 메타데이터 파싱 실패 항목은 로그로 남기고 퀴즈 출제 대상에서 제외
- 이미지 로딩 실패 시 대체 텍스트와 함께 다음 문제로 건너뛰기
- 동일 문제 반복 방지를 위해 최근 출제된 이미지 ID 세트를 유지하고 일정 횟수 이후 초기화

### 6. 개발 및 실행 계획
1. `metadata_loader.py` 작성: 파일명 파서, CSV 생성/로딩, 유닛테스트 가능한 함수화
2. `quiz_engine.py` 구현: 퀴즈 데이터 클래스, 보기 생성 로직, 정답 검증 함수
3. `app.py` 작성: Streamlit UI, 세션 상태 초기화, 이벤트 흐름 연결
4. 필요 시 `requirements.txt`에 주요 라이브러리(Streamlit, pandas, Pillow) 명시
5. 실행 방법 문서화: `streamlit run app.py` 중심으로 환경 셋업 절차 포함

### 7. 향후 확장 아이디어
- 난이도(연식 범위, 제조사 범위) 선택 기능
- 사용자별 기록 저장 및 리더보드
- 자동차 유형(세단, SUV 등) 필터 적용
- 타이머 기반 점수 가중치 또는 오답 분석 리포트

위 구조를 기반으로 다음 단계에서 실제 코드를 작성하고 실행 방법을 README에 추가할 예정이다.
